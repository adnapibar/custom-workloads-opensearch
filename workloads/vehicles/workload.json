{
    "version": 2,
    "description": "Vehicles benchmark",
    "indices": [
        {
            "name": "vehicles",
            "body": "index.json"
        }
    ],
    "schedule": [
        {
            "operation": {
                "operation-type": "cluster-health",
                "request-params": {
                    "wait_for_status": "green"
                },
                "retry-until-success": true
            }
        },
        {
            "name": "date_histogram_agg",
            "operation": {
                "operation-type": "search",
                "body": {
                    "size": 0,
                    "query": {
                        "range": {
                            "timestamp": {
                                "gte": "01/11/2022",
                                "lte": "21/11/2022",
                                "format": "dd/MM/yyyy"
                            }
                        }
                    },
                    "aggs": {
                        "sales_over_time": {
                            "date_histogram": {
                                "field": "timestamp",
                                "calendar_interval": "day"
                            }
                        }
                    }
                },
                "warmup-iterations": 50,
                "iterations": 100,
                "target-throughput": 1.5
            }
        },
        {
            "name": "date_histogram_subaggs",
            "operation": {
                "operation-type": "search",
                "body": {
                    "size": 0,
                    "query": {
                        "range": {
                            "timestamp": {
                                "gte": "2022-11-01 00:00:00",
                                "lte": "2022-11-10 23:59:59"
                            }
                        }
                    },
                    "aggs": {
                        "sales_over_time": {
                            "date_histogram": {
                                "field": "timestamp",
                                "fixed_interval": "60s"
                            },
                            "aggs": {
                                "make_type": {
                                    "terms": {
                                        "field": "make"
                                    },
                                    "aggs": {
                                        "total_sale": {
                                            "sum": {
                                                "field": "count"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "warmup-iterations": 50,
                "iterations": 100,
                "target-throughput": 1.5
            }
        }
    ]
}